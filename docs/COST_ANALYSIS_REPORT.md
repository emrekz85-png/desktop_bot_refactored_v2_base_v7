# Cost Analysis Report: Filter Combo Realism Test

**Date:** 2026-01-03
**Symbol:** BTCUSDT | **Timeframe:** 15m | **Period:** 365 days
**Config:** REGIME + at_flat_filter + adx_filter

---

## Executive Summary

The filter combo that showed +$15.91 PnL in ideal testing **actually loses -$4.07** when realistic trading costs are applied. This document explains why and what it means.

---

## Problem Statement

Filter combo tests use a simplified `simulate_trade()` function:
```python
pnl = (exit_price - entry_price) / entry_price * $35
```

This ignores:
- Slippage (price impact on entry/exit)
- Commission (Binance fees)
- Partial fills
- Order book depth

---

## Apple-to-Apple Comparison

| Metric | Ideal (No Costs) | With Costs | Difference |
|--------|------------------|------------|------------|
| Trades | 238 | 238 | 0 |
| Win Rate | 31.5% | 31.5% | 0% |
| Gross PnL | $15.91 | $7.59 | -$8.32 |
| Total Fees | $0.00 | $11.66 | - |
| **Net PnL** | **$15.91** | **-$4.07** | **-$19.98** |

### Cost Breakdown:
- **Slippage Loss:** $8.32 (0.05% × 2 sides × 238 trades × $35)
- **Commission:** $11.66 (0.07% × 2 sides × 238 trades × $35)
- **Total Cost:** $19.98

---

## Cost Sensitivity Analysis

| Scenario | Slippage | Fee Rate | Net PnL | Status |
|----------|----------|----------|---------|--------|
| Zero Costs | 0.000% | 0.000% | +$15.91 | Profitable |
| VIP Tier (Low) | 0.010% | 0.020% | +$10.91 | Profitable |
| Medium Costs | 0.030% | 0.050% | +$2.58 | Barely Profitable |
| **Current Config** | 0.050% | 0.070% | **-$4.07** | **Loss** |
| High Costs | 0.100% | 0.100% | -$17.39 | Large Loss |

---

## Key Metrics

### Strategy Edge Analysis
```
Total PnL (Ideal): $15.91
Number of Trades: 238
Edge per Trade: $0.067 (0.19% of $35 position)
```

### Cost Structure
```
Round-trip Slippage: 0.10% (0.05% × 2)
Round-trip Commission: 0.14% (0.07% × 2)
Total Round-trip Cost: 0.24%
```

### Profitability Equation
```
Edge (0.19%) < Costs (0.24%) = NET LOSS
```

---

## Break-Even Analysis

To be profitable, total round-trip costs must be < 0.19%

| Slippage | Max Commission | Status |
|----------|---------------|--------|
| 0.00% | 0.095% | Need ~VIP3 tier |
| 0.01% | 0.085% | Need VIP2-3 tier |
| 0.02% | 0.075% | Need VIP1-2 tier |
| 0.03% | 0.065% | Marginal |
| 0.05% | 0.045% | Not achievable |

---

## Recommendations

### Option 1: Reduce Trading Costs
- Achieve VIP tier on Binance (lower fees)
- Use maker-only orders (0.02% instead of 0.07%)
- Trade during high liquidity (reduce slippage)

### Option 2: Increase Strategy Edge
- Find filter combos with higher win rate or larger average profit
- Target: Edge > 0.30% per trade to cover costs
- Current best is still insufficient

### Option 3: Reduce Trade Frequency
- More selective signals = lower total costs
- But also lower total profit potential
- Need to find sweet spot

### Option 4: Accept Current Reality
- Strategy is not profitable with current cost structure
- Use for paper trading / signal validation only
- Do not deploy with real capital

---

## Test Commands

```bash
# Apple-to-apple comparison
python runners/run_realistic_backtest.py \
    --filters "regime,at_flat_filter,adx_filter" \
    --compare

# Cost-aware only test
python runners/run_realistic_backtest.py \
    --filters "regime,at_flat_filter,adx_filter" \
    --cost-aware

# SimTradeManager test (variable position sizing)
python runners/run_realistic_backtest.py \
    --filters "regime,at_flat_filter,adx_filter" \
    --sim-trade-manager
```

---

## Conclusion

**The filter combo results are NOT realistic.**

While +$15.91 looks promising in ideal testing, the real-world result with 0.05% slippage and 0.07% commission is **-$4.07 loss**.

The strategy's edge (0.19% per trade) is too small to overcome trading costs (0.24% round-trip).

**Do not deploy this configuration with real capital.**

---

*Report generated by run_realistic_backtest.py*
